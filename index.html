<script>
let lang = 'en'; // default

function setLang(l) {
  lang = l;
  if(lang==='ur'){
    document.getElementById('heading').innerText = "پاکستان میں سونا اور چاندی کے تازہ نرخ";
    document.getElementById('gold-title').innerText = "سونا (24 قیراط / تولہ)";
    document.getElementById('silver-title').innerText = "چاندی (تولہ)";
    document.getElementById('usd-title').innerText = "ڈالر → روپیہ";
  } else {
    document.getElementById('heading').innerText = "Live Gold & Silver Prices | پاکستان";
    document.getElementById('gold-title').innerText = "Gold (24K / Tola)";
    document.getElementById('silver-title').innerText = "Silver (Tola)";
    document.getElementById('usd-title').innerText = "USD → PKR";
  }
}

// Function to fetch prices
function fetchPrices() {
  // Fetch USD → PKR
  fetch("https://api.exchangerate.host/latest?base=USD&symbols=PKR")
    .then(r => r.json())
    .then(d => {
      const usdToPkr = d.rates.PKR;
      document.getElementById("usd").innerText =
        lang==='ur' ? `1 ڈالر = ${usdToPkr} روپیہ` : `1 USD = ${usdToPkr} PKR`;

      // Fetch Gold & Silver
      fetch("https://metals-api.com/api/latest?access_key=demo&base=USD&symbols=XAU,XAG")
        .then(r => r.json())
        .then(data => {
          const goldUsdOz = data.rates.XAU;
          const silverUsdOz = data.rates.XAG;

          const OZ_TO_GRAM = 31.1035;
          const TOLA_IN_GRAM = 11.664;

          const goldPerGram = (goldUsdOz * usdToPkr) / OZ_TO_GRAM;
          const silverPerGram = (silverUsdOz * usdToPkr) / OZ_TO_GRAM;

          const goldTola24k = Math.round(goldPerGram * TOLA_IN_GRAM * 1.0);
          const goldTola22k = Math.round(goldPerGram * TOLA_IN_GRAM * 0.916);
          const silverTola = Math.round(silverPerGram * TOLA_IN_GRAM);

          document.getElementById("gold").innerText =
            lang==='ur' ?
            `24 قیراط: ${goldTola24k} | 22 قیراط: ${goldTola22k} روپیہ` :
            `24K: ${goldTola24k} PKR | 22K: ${goldTola22k} PKR`;

          document.getElementById("silver").innerText =
            lang==='ur' ? `${silverTola} روپیہ` : `${silverTola} PKR`;
        });
    });
}

// Fetch prices immediately on page load
fetchPrices();

// Update every 60 seconds
setInterval(fetchPrices, 60000);
</script>
